<!doctype html>
<html lang="en">

<head>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-168203025-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-168203025-1');
  </script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" type="image/svg+xml" href="media/index/browser_tab.svg">

  <title>Maggie Liu - Product Designer</title>
  <link rel="stylesheet" href="css/globals.css" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/fonts.css" />
  <link rel="stylesheet" href="css/grid.css" />

</head>

<body>
  

  <main class="d-landing">
    <div class="div">

      <div id="site-header"></div>

      <div class="grid-row">
        
        <section class="portfolio-section grid-col-4of12">
          <div class="frame-2">
            <a href="jde.html" class="frame-3" data-index="0">
              <div style="display: flex; flex-direction: column; align-items: flex-start; gap: 8px;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2024</h2>
                  <h2 class="text-wrapper-4">JACOBS DOUWE EGBERTS</h2>
                </div>
                <span class="text-wrapper-5">[whitelabel design system]</span>
              </div>
            </a>

            <a href="marinaAbramovic.html" class="frame-3" data-index="1">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2024</h2>
                  <h2 class="text-wrapper-4">MARINA ABRAMOVIĆ ✦</h2>
                </div>
                <span class="text-wrapper-5">[microsite]</span>
              </div>
            </a>

            <a href="montblanc.html" class="frame-3" data-index="2">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2023</h2>
                  <h2 class="text-wrapper-4">MONTBLANC DIGITAL PAPER</h2>
                </div>
                <span class="text-wrapper-5">[e-ink experience]</span>
              </div>
            </a>

            <a href="photography.html" class="frame-3" data-index="3">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2023</h2>
                  <h2 class="text-wrapper-4">PHOTOGRAPHY ✦</h2>
                </div>
                <span class="text-wrapper-5">[visual experiments]</span>
              </div>
            </a>

            <a href="toyota.html" class="frame-3" data-index="4">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2022</h2>
                  <h2 class="text-wrapper-4">TOYOTA</h2>
                </div>
                <span class="text-wrapper-5">[global navigation]</span>
              </div>
            </a>

            <a href="puma.html" class="frame-3" data-index="5">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2019</h2>
                  <h2 class="text-wrapper-4">PUMA: RUN MY WAY 管我怎么跑</h2>
                </div>
                <span class="text-wrapper-5">[interactive installation]</span>
              </div>
            </a>

            <a href="lufthansa.html" class="frame-3" data-index="6">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2019</h2>
                  <h2 class="text-wrapper-4">LUFTHANSA: #LIFECHANGINGPLACES</h2>
                </div>
                <span class="text-wrapper-5">[image recognition]</span>
              </div>
            </a>

            <a href="alice.html" class="frame-3" data-index="7">
              <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <div class="gallery-caption">
                  <h2 class="text-wrapper-4">2019</h2>
                  <h2 class="text-wrapper-4">ALICE'S ADVENTURES IN WONDERLAND ✦</h2>
                </div>
                <span class="text-wrapper-5">[print]</span>
              </div>
            </a>
            
          </div>
        </section>

        <section class="gallery-section grid-col-8of12">
            <div class="grid-row--column grid-col-1of12">
              <a href="jde.html" class="hover-swap" data-index="0">
                <img src="media/index/jde_before.png" class="default-img" alt="JDE">
                <img src="media/index/jde_after.gif" class="hover-img" alt="Alternate image">
              </a>  

              <a href="marinaAbramovic.html" class="hover-swap" data-index="1">
                <img src="media/index/ma_before.png" class="default-img" alt="Marina Abramović">
                <img src="media/index/ma_after.png" class="hover-img" alt="Alternate image">
              </a> 
            </div>

            <div class="grid-row--column grid-col-2of12">
              <a href="montblanc.html" class="hover-swap" data-index="2">
                <img src="media/index/mb_before_1.png" class="default-img" alt="Montblanc">
                <img src="media/index/mb_after_1.png" class="hover-img" alt="Alternate image">
              </a> 

              <a href="photography.html" class="hover-swap" data-index="3">
                <img src="media/index/dolomiti_before.png" class="default-img" alt="Dolomiti">
                <img src="media/index/dolomiti_after.png" class="hover-img" alt="Alternate image">
              </a>  
            </div>

            <div class="grid-row--column grid-col-3of12">
              <a href="toyota.html" class="hover-swap" data-index="4">
                <img src="media/index/toyota_before.png" class="default-img" alt="Toyota">
                <img src="media/index/toyota_after.png" class="hover-img" alt="Alternate image">
              </a>  

              <a href="puma.html" class="hover-swap" data-index="5">
                <img src="media/index/puma_before.png" class="default-img" alt="Puma">
                <img src="media/index/puma_after.png" class="hover-img" alt="Alternate image">
              </a> 
            </div>

            <div class="grid-row--column grid-col-2of12">
              <a href="lufthansa.html" class="hover-swap" data-index="6">
                <img src="media/index/lufthansa_before.png" class="default-img" alt="Lufthansa">
                <img src="media/index/lufthansa_after.png" class="hover-img" alt="Alternate image">
              </a>  

              <a href="alice.html" class="hover-swap" data-index="7">
                <img src="media/index/alice_before.png" class="default-img" alt="Alice">
                <img src="media/index/alice_after.png" class="hover-img" alt="Alternate image">
              </a> 
            </div>
          </div>
        </section>
      </div>
      
    </div>
  </main>

  
    
<script>
  const allPortfolioItems = document.querySelectorAll('.frame-3[data-index]');
  const allGalleryItems = document.querySelectorAll('.gallery-section [data-index]');
  const allHoverSwap = document.querySelectorAll('.hover-swap');

  function setHighlight(activeIndex) {
    allPortfolioItems.forEach(item => {
      const title = item.querySelector('.frame-3');
      const subtitle = item.querySelector('.frame-3');
      const isActive = item.getAttribute('data-index') === activeIndex;
      if (title) title.style.opacity = isActive ? '1' : '0.25';
      if (subtitle) subtitle.style.opacity = isActive ? '1' : '0.25';
      item.style.opacity = '1';
    });
    allGalleryItems.forEach(item => {
      item.style.opacity = item.getAttribute('data-index') === activeIndex ? '1' : '0.25';
    });
  }

  function resetHighlight() {
    allPortfolioItems.forEach(item => {
      const title = item.querySelector('.text-wrapper-4');
      const subtitle = item.querySelector('.text-wrapper-5');
      if (title) title.style.opacity = '1';
      if (subtitle) subtitle.style.opacity = '1';
      item.style.opacity = '1';
    });
    allGalleryItems.forEach(item => { item.style.opacity = '1'; });
  }

  // Gallery image swap for tablet
  let gallerySwapInterval = null;
  let currentActiveIndex = null;

  function setActiveGalleryItem(index) {
    document.querySelectorAll('.gallery-section .hover-swap')
      .forEach(item => item.classList.remove('active'));
    const activeSwap = document.querySelector(`.gallery-section .hover-swap[data-index="${index}"]`);
    if (activeSwap) activeSwap.classList.add('active');
  }

  function startGallerySwap(index) {
    stopGallerySwap();
    currentActiveIndex = index;
    const activeSwap = document.querySelector(`.gallery-section .hover-swap[data-index="${index}"]`);
    if (!activeSwap) return;
    const defaultImg = activeSwap.querySelector('.default-img');
    const hoverImg = activeSwap.querySelector('.hover-img');
    let showHover = false;

    // start with default visible, hover hidden
    if (defaultImg) { defaultImg.style.display = 'block'; defaultImg.style.opacity = '1'; }
    if (hoverImg)  { hoverImg.style.display = 'none'; hoverImg.style.opacity = '0'; }

    gallerySwapInterval = setInterval(() => {
      showHover = !showHover;
      if (showHover) {
        if (hoverImg)  { hoverImg.style.display = 'block'; hoverImg.style.opacity = '1'; }
        if (defaultImg){ defaultImg.style.display = 'none'; defaultImg.style.opacity = '0'; }
      } else {
        if (hoverImg)  { hoverImg.style.display = 'none'; hoverImg.style.opacity = '0'; }
        if (defaultImg){ defaultImg.style.display = 'block'; defaultImg.style.opacity = '1'; }
      }
    }, 1000); // <- change this number (milliseconds)
  }

  function stopGallerySwap() {
    clearInterval(gallerySwapInterval);
    gallerySwapInterval = null;
    if (currentActiveIndex !== null) {
      const activeSwap = document.querySelector(`.gallery-section .hover-swap[data-index="${currentActiveIndex}"]`);
      if (activeSwap) {
        const defaultImg = activeSwap.querySelector('.default-img');
        const hoverImg = activeSwap.querySelector('.hover-img');
        if (defaultImg) { defaultImg.style.display = 'block'; defaultImg.style.opacity = '1'; }
        if (hoverImg)  { hoverImg.style.display = 'none'; hoverImg.style.opacity = '0'; }
      }
    }
    currentActiveIndex = null;
  }

  function tabletHighlightLogic() {
    if (window.innerWidth <= 1023) {
      // Tablet: click-based single highlight (same as mobile)
      setActiveGalleryItem('0');
      setHighlight('0');
      startGallerySwap('0');

      // Tap/click highlight (safe to reassign .onclick)
      document.querySelectorAll('.frame-3[data-index]').forEach(item => {
        item.onclick = () => {
          const index = item.getAttribute('data-index');
          setHighlight(index);
          setActiveGalleryItem(index);
          startGallerySwap(index);
        };
      });
    } else if (window.innerWidth > 768) {
      // Desktop: hover dimming
      allPortfolioItems.forEach(item => {
        item.onmouseenter = () => {
          const index = item.getAttribute('data-index');
          setHighlight(index);
          allPortfolioItems.forEach(other => {
            other.style.opacity = other === item ? '1' : '0.25';
          });
          allGalleryItems.forEach(other => {
            other.style.opacity = other.getAttribute('data-index') === index ? '1' : '0.25';
          });

          // show hover image for the matching gallery item immediately
          stopGallerySwap();
          const gallerySwap = document.querySelector(`.gallery-section .hover-swap[data-index="${index}"]`);
          if (gallerySwap) {
            const defaultImg = gallerySwap.querySelector('.default-img');
            const hoverImg = gallerySwap.querySelector('.hover-img');
            if (defaultImg) { defaultImg.style.display = 'none'; defaultImg.style.opacity = '0'; }
            if (hoverImg)  { hoverImg.style.display = 'block'; hoverImg.style.opacity = '1'; }
          }
        };
        item.onmouseleave = () => {
          resetHighlight();
          allPortfolioItems.forEach(other => { other.style.opacity = '1'; });
          allGalleryItems.forEach(other => { other.style.opacity = '1'; });

          // revert images for the matching gallery item
          const index = item.getAttribute('data-index');
          const gallerySwap = document.querySelector(`.gallery-section .hover-swap[data-index="${index}"]`);
          if (gallerySwap) {
            const defaultImg = gallerySwap.querySelector('.default-img');
            const hoverImg = gallerySwap.querySelector('.hover-img');
            if (defaultImg) { defaultImg.style.display = 'block'; defaultImg.style.opacity = '1'; }
            if (hoverImg)  { hoverImg.style.display = 'none'; hoverImg.style.opacity = '0'; }
          }
        };
      });

      allGalleryItems.forEach(item => {
        item.onmouseenter = () => {
          const index = item.getAttribute('data-index');
          setHighlight(index);
          allGalleryItems.forEach(other => {
            other.style.opacity = other === item ? '1' : '0.25';
          });
          allPortfolioItems.forEach(other => {
            other.style.opacity = other.getAttribute('data-index') === index ? '1' : '0.25';
          });

          // show hover image for this gallery item
          stopGallerySwap();
          const gallerySwap = document.querySelector(`.gallery-section .hover-swap[data-index="${index}"]`);
          if (gallerySwap) {
            const defaultImg = gallerySwap.querySelector('.default-img');
            const hoverImg = gallerySwap.querySelector('.hover-img');
            if (defaultImg) { defaultImg.style.display = 'none'; defaultImg.style.opacity = '0'; }
            if (hoverImg)  { hoverImg.style.display = 'block'; hoverImg.style.opacity = '1'; }
          }
        };
        item.onmouseleave = () => {
          resetHighlight();
          allGalleryItems.forEach(other => { other.style.opacity = '1'; });
          allPortfolioItems.forEach(other => { other.style.opacity = '1'; });

          // revert images for this gallery item
          const index = item.getAttribute('data-index');
          const gallerySwap = document.querySelector(`.gallery-section .hover-swap[data-index="${index}"]`);
          if (gallerySwap) {
            const defaultImg = gallerySwap.querySelector('.default-img');
            const hoverImg = gallerySwap.querySelector('.hover-img');
            if (defaultImg) { defaultImg.style.display = 'block'; defaultImg.style.opacity = '1'; }
            if (hoverImg)  { hoverImg.style.display = 'none'; hoverImg.style.opacity = '0'; }
          }
        };
      });
    }
  }

  window.addEventListener('DOMContentLoaded', tabletHighlightLogic);
  window.addEventListener('resize', tabletHighlightLogic);
</script>


<script>
  /* Mobile column-switcher: show the column that contains the clicked gallery item
    and ensure only one preview is visible. */
  (function () {
    const MOBILE_MAX = 1023;
    function isMobile() { return window.innerWidth <= MOBILE_MAX; }

    function clearActiveStates() {
      document.querySelectorAll('.gallery-section .grid-row--column').forEach(c => c.classList.remove('active-col'));
      document.querySelectorAll('.gallery-section .hover-swap').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.frame-3[data-index]').forEach(p => p.classList.remove('active','dimmed'));
    }

    function showColumnForIndex(idx) {
      if (!isMobile()) return;
      const targetIndex = String(idx);
      const swaps = Array.from(document.querySelectorAll('.gallery-section .hover-swap[data-index]'));
      const cols = Array.from(document.querySelectorAll('.gallery-section .grid-row--column'));
      if (!swaps.length || !cols.length) return;

      // activate only the exact hover-swap
      swaps.forEach(s => s.classList.toggle('active', s.getAttribute('data-index') === targetIndex));

      // activate only the column that contains that swap
      cols.forEach(col => {
        const contains = !!col.querySelector(`.hover-swap[data-index="${targetIndex}"]`);
        col.classList.toggle('active-col', contains);
      });

      // highlight the matching portfolio item (dim others)
    document.querySelectorAll('.frame-3[data-index]').forEach(p => {
      const is = p.getAttribute('data-index') === targetIndex;
      p.classList.toggle('active', is);
      p.classList.toggle('dimmed', !is);
    });

    // remeasure gallery height for current vw/active item
    if (typeof setGalleryHeight === 'function') setGalleryHeight();
    }

    function initMobileHandlers() {
      if (!isMobile()) {
        clearActiveStates();
        return;
      }
      // if an item is already active keep it; otherwise show nothing until user selects
      const existing = document.querySelector('.gallery-section .hover-swap.active[data-index]');
      if (existing) showColumnForIndex(existing.getAttribute('data-index'));
      else clearActiveStates();
    }

    document.addEventListener('DOMContentLoaded', initMobileHandlers);
    window.addEventListener('resize', initMobileHandlers);

    document.addEventListener('click', (e) => {
    if (!isMobile()) return;
    const el = e.target.closest('.frame-3[data-index], .gallery-section .hover-swap[data-index]');
    if (!el) return;
    const idx = el.getAttribute('data-index');
    if (!idx) return;
    e.preventDefault();

    // If the clicked item is already active → open link
    if (el.classList.contains('active')) {
      const href = el.getAttribute('href');
      if (href) window.location.href = href;
      return;
    }

    // Otherwise → show gallery / make it active
    showColumnForIndex(idx);
  }, true);
  })();
</script>

<script>
  // Calculate and set fixed height for gallery grid row based on tallest item
  async function setGalleryHeight() {
    if (window.innerWidth > 1023) {
      const gallerySection = document.querySelector('.gallery-section');
      if (gallerySection) {
        gallerySection.style.height = gallerySection.style.minHeight = '';
        const gridRow = gallerySection.querySelector('.grid-row');
        if (gridRow) gridRow.style.height = gridRow.style.minHeight = '';
      }
      return;
    }

    const gallerySection = document.querySelector('.gallery-section');
    if (!gallerySection) return;
    const swaps = Array.from(gallerySection.querySelectorAll('.hover-swap'));
    if (!swaps.length) {
      gallerySection.style.height = gallerySection.style.minHeight = '';
      return;
    }

    const spanMap = {
      '0': 2, '1': 2,
      '2': 3, '3': 3,
      '4': 4, '5': 4, '6': 4, '7': 4
    };

    const galleryInnerWidth = Math.max(1, gallerySection.clientWidth);

    // ensure images loaded
    const imgs = Array.from(gallerySection.querySelectorAll('img'));
    await Promise.all(imgs.map(img => img.complete ? Promise.resolve() : new Promise(res => {
      img.addEventListener('load', res, { once: true });
      img.addEventListener('error', res, { once: true });
    })));

    let maxHeight = 0;

    for (const swap of swaps) {
      const idx = swap.getAttribute('data-index');
      const span = spanMap[idx] || 4;
      const img = swap.querySelector('.default-img') || swap.querySelector('img');

      if (img && img.naturalWidth > 0) {
        const displayWidth = Math.floor((span / 6) * galleryInnerWidth);
        const h = Math.ceil(displayWidth * (img.naturalHeight / img.naturalWidth));
        if (h > maxHeight) maxHeight = h;
      } else {
        // fallback: temporarily measure rendered swap (no flash)
        const clone = swap.cloneNode(true);
        clone.style.boxSizing = 'border-box';
        clone.style.width = Math.max(1, Math.floor((span / 6) * galleryInnerWidth)) + 'px';
        clone.style.position = 'absolute';
        clone.style.left = '-99999px';
        clone.style.top = '0';
        clone.style.visibility = 'hidden';
        document.body.appendChild(clone);
        await new Promise(r => requestAnimationFrame(r));
        const h = Math.ceil(clone.getBoundingClientRect().height);
        document.body.removeChild(clone);
        if (h > maxHeight) maxHeight = h;
      }
    }

    // apply measured height to the grid-row (preferred) and set gallery section min-height as fallback
    const gridRowEl = document.querySelector('.gallery-section .grid-row') || document.querySelector('.gallery-section');
    if (maxHeight > 0) {
      gridRowEl.style.height = gridRowEl.style.minHeight = maxHeight + 'px';
      // keep section flow natural
      const gallerySectionEl = document.querySelector('.gallery-section');
      if (gallerySectionEl) {
        gallerySectionEl.style.minHeight = maxHeight + 'px';
        gallerySectionEl.style.height = 'auto';
      }
    } else {
      gridRowEl.style.height = gridRowEl.style.minHeight = '';
      const gallerySectionEl = document.querySelector('.gallery-section');
      if (gallerySectionEl) gallerySectionEl.style.minHeight = gallerySectionEl.style.height = '';
    }
  }

  // expose for manual calls
  window.setGalleryHeight = setGalleryHeight;

  // ensure it's run on load and resize
  window.addEventListener('load', setGalleryHeight);
  window.addEventListener('resize', () => {
    // throttle a bit to avoid too-frequent runs
    clearTimeout(window.___setGalleryHeightTimeout);
    window.___setGalleryHeightTimeout = setTimeout(setGalleryHeight, 120);
  });
</script>

<script>
  (function () {
    // attach once
    if (window._desktopResetAttached) return;
    window._desktopResetAttached = true;

    function isDesktop() { return window.innerWidth > 1023; }

    function restoreAll() {
      // revert visual dimming/state
      resetHighlight();
      stopGallerySwap();
      document.querySelectorAll('.frame-3[data-index]').forEach(i => i.style.opacity = '1');
      document.querySelectorAll('.gallery-section [data-index]').forEach(i => i.style.opacity = '1');
      // ensure gallery images show default image
      document.querySelectorAll('.gallery-section .hover-swap').forEach(s => {
        const def = s.querySelector('.default-img');
        const hov = s.querySelector('.hover-img');
        if (def) { def.style.display = 'block'; def.style.opacity = '1'; }
        if (hov) { hov.style.display = 'none'; hov.style.opacity = '0'; }
      });
    }

    function pointerHandler(e) {
      if (!isDesktop()) return;
      const el = document.elementFromPoint(e.clientX, e.clientY);
      if (!el) { restoreAll(); return; }
      if (el.closest('.frame-3') || el.closest('.gallery-section .hover-swap')) {
        // hovering over an interactive element — do nothing (existing hover handlers run)
        return;
      }
      // not over any interactive element: restore
      restoreAll();
    }

    // prefer container mouseleave (fast) and also global mousemove as fallback
    const container = document.querySelector('.d-landing .div') || document.body;
    container.addEventListener('mouseleave', () => { if (isDesktop()) restoreAll(); });
    document.addEventListener('mousemove', pointerHandler);

    // ensure listeners adapt on resize
    window.addEventListener('resize', () => { if (!isDesktop()) restoreAll(); });
  })();
</script>



<script>
  /* Ensure first gallery preview (data-index="0") is visible on load and sync portfolio highlight.
    Also start tablet swap if on tablet. This is defensive (won't throw if helper functions absent). */
  document.addEventListener('DOMContentLoaded', function () {
    try {
      // ensure one active hover-swap (prefer existing, else first)
      const swaps = Array.from(document.querySelectorAll('.gallery-section .hover-swap[data-index]'));
      if (swaps.length === 0) return;

      // find an existing active, otherwise pick index 0 (JDE)
      let active = swaps.find(s => s.classList.contains('active')) || swaps.find(s => s.getAttribute('data-index') === '0') || swaps[0];

      swaps.forEach(s => s.classList.toggle('active', s === active));

      // ensure only the column containing the active swap is visible on mobile (if your mobile CSS uses .active-col)
      const cols = Array.from(document.querySelectorAll('.gallery-section .grid-row--column'));
      cols.forEach(col => {
        const contains = !!col.querySelector('.hover-swap.active');
        col.classList.toggle('active-col', contains);
      });

      // sync portfolio highlight: mark corresponding .frame-3 active and dim others
      const activeIndex = active.getAttribute('data-index');
      const ports = Array.from(document.querySelectorAll('.frame-3[data-index]'));
      ports.forEach(p => {
        const is = p.getAttribute('data-index') === activeIndex;
        p.classList.toggle('active', is);
        p.classList.toggle('dimmed', !is);
        // ensure title/subtitle opacity matches (keeps consistency if JS elsewhere uses inline styles)
        const title = p.querySelector('.frame-3');
        const subtitle = p.querySelector('.frame-3');
        if (title) title.style.opacity = is ? '1' : '0.25';
        if (subtitle) subtitle.style.opacity = is ? '1' : '0.25';
        p.style.opacity = '1';
      });

      // ensure gallery images inside the active swap show default image initially
      try {
        const def = active.querySelector('.default-img');
        const hov = active.querySelector('.hover-img');
        if (def) { def.style.display = 'block'; def.style.opacity = '1'; }
        if (hov) { hov.style.display = 'none'; hov.style.opacity = '0'; }
      } catch (e) { /* ignore */ }

      // If tablet functions exist, start tablet behavior for index 0 when on tablet
      if (typeof setActiveGalleryItem === 'function') {
        setActiveGalleryItem(activeIndex);
      }
      if (typeof setHighlight === 'function') {
        setHighlight(activeIndex);
      }
      if (typeof startGallerySwap === 'function' && window.innerWidth > 375 && window.innerWidth <= 768) {
        startGallerySwap(activeIndex);
      }
    } catch (err) {
      // log for debugging (remove in production)
      console.error('init gallery failed:', err);
    }
    
  });
</script>


<script>
  window.addEventListener('load', function () {
  const idx = '0';
  // Ensure exactly one hover-swap is active
  document.querySelectorAll('.gallery-section .hover-swap[data-index]').forEach(s => {
    s.classList.toggle('active', s.getAttribute('data-index') === idx);
  });

  // On mobile: show the column containing the active swap
  if (window.innerWidth <= 1023) {
    document.querySelectorAll('.gallery-section .grid-row--column').forEach(col => {
      col.classList.toggle('active-col', !!col.querySelector(`.hover-swap[data-index="${idx}"]`));
    });
  }

  // For tablet/mobile behavior and highlights
  if (typeof setActiveGalleryItem === 'function') setActiveGalleryItem(idx);
  if (typeof setHighlight === 'function') setHighlight(idx);

  // Start tablet swap only on tablet (not on mobile)
  if (typeof startGallerySwap === 'function' && window.innerWidth <= 1023) {
    startGallerySwap(idx);
  }

  document.querySelectorAll('.frame-3[data-index]').forEach(p => {
  // remove active/dimmed classes entirely
  p.classList.remove('active', 'dimmed');

  // make sure titles and subtitles are fully opaque
  const title = p.querySelector('.gallery-caption');
  const subtitle = p.querySelector('.frame-3');
  if (title) title.style.opacity = '1';
  if (subtitle) subtitle.style.opacity = '1';
  p.style.opacity = '1';
});
});
</script>

<script>
  (function () {
    // measure gallery height and publish to CSS var so portfolio is pushed down
    const docEl = document.documentElement;
    const GAP = 16; // extra gap below gallery

    async function updateGalleryFixedHeight() {
      const gallery = document.querySelector('.gallery-section');
      const portfolio = document.querySelector('.portfolio-section');
      if (!gallery) {
        docEl.style.setProperty('--gallery-fixed-height', '0px');
        if (portfolio) portfolio.style.marginTop = '';
        return;
      }

      if (window.innerWidth > 1023) {
        // clear on desktop
        docEl.style.setProperty('--gallery-fixed-height', '0px');
        if (portfolio) portfolio.style.marginTop = '';
        return;
      }

      // wait for images inside gallery to settle to avoid 0 heights
      const imgs = Array.from(gallery.querySelectorAll('img'));
      await Promise.all(imgs.map(img => img.complete ? Promise.resolve() : new Promise(res => {
        img.addEventListener('load', res, { once: true });
        img.addEventListener('error', res, { once: true });
      })));

      // measure rendered gallery height
      const rect = gallery.getBoundingClientRect();
      const h = Math.max(0, Math.ceil(rect.height));

      // publish CSS var and set inline portfolio margin as immediate fallback
      docEl.style.setProperty('--gallery-fixed-height', h + 'px');
      if (portfolio) portfolio.style.marginTop = (h + GAP) + 'px';
    }

    // expose for manual calls and for other scripts to call after dynamic changes
    window.updateGalleryFixedHeight = updateGalleryFixedHeight;

    // run on load and resize (throttled)
    window.addEventListener('load', updateGalleryFixedHeight);
    let __gTimeout = null;
    window.addEventListener('resize', () => {
      clearTimeout(__gTimeout);
      __gTimeout = setTimeout(updateGalleryFixedHeight, 120);
    });
  })();
</script>


<script src="js/load-partials.js" defer></script>

</body>

</html>